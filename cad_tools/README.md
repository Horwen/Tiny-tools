---

# P 图层置前工具（双击可运行）

本工具用于批量处理当前目录下所有 **DWG 图纸**，将图层 **P** 上的所有对象统一执行 **DRAWORDER → Front（置于最前）** 操作。

脚本已经按“**双击即可运行**”的方式编写，无需在终端手动输入命令。

---

## 功能说明

* 双击脚本即可一次性处理整个文件夹
* 自动遍历当前目录下所有 `.dwg` 文件
* 识别图层名 **“P”** 的所有对象
* 执行 **置于最前**（DRAWORDER Front）
* 自动保存修改并关闭图纸
* 支持复用已打开的 AutoCAD，或自动启动 AutoCAD

---

## 使用方法（非常简单）

### 1. 将脚本与 DWG 放在同一个文件夹

目录示例：

```
your-folder/
├── layer_P_to_front.py
├── 01-A.dwg
├── 02-B.dwg
└── 03-C.dwg
```

### 2. **直接双击** `layer_P_to_front.py`

脚本将自动：

1. 连接或启动 AutoCAD
2. 顺序打开每个 DWG
3. 查找图层 **P** 的所有实体
4. 执行置前
5. 保存并关闭

执行时会自动弹出 AutoCAD 界面（可最小化）。

---

## 环境要求

### 必须满足以下条件：

1. **Windows 系统**
2. **AutoCAD 2020–2024（64-bit）**
3. **Python 3.8+（64-bit）**
4. Python 安装了 `pywin32` 模块（仅第一次需要）：

```bash
pip install pywin32
```

装一次即可，之后都可以双击运行脚本。

---

## 注意事项

* 图层名需**完全等于 P**。
  如需支持 `P-xxx`、多个图层或通配符，我可以帮你定制。
* 脚本会直接修改原 DWG（自动保存），建议先备份。
* 如果双击无反应，请确认 Windows 已将 `.py` 关联到 Python。
  如未关联，可右键脚本 → “用 Python 运行”。

---

## 常见问题

### 1. 双击后 AutoCAD 弹出但脚本没有继续？

第一次启动 AutoCAD 或插件初始化较慢，稍等即可。

### 2. 报错：“无法连接 AutoCAD”？

请确认：

* AutoCAD 能手动正常打开
* Python 为 **64-bit**
* 已安装 `pywin32`
* 你不是在管理员 AutoCAD + 普通权限 Python（权限不一致会失败）

如仍有问题，请把报错信息发给我，我帮你调整版本。

---

## License

自由使用，支持在工程项目中使用、修改与分享。

---

